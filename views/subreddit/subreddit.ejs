<!DOCTYPE html>
<html lang="en">
  <%- include('../partials/head', {title: "Beddit - " + info.name}) %>

  <body>
    <%- include('../partials/nav', {user: locals.user, karma, name:info.name})
    %>
    <span id="auth"><%= isAuth %></span>

    <div class="grid-container">
      <div class="sidebar">
        <%- include('../partials/sidebar_subreddit_actions', {name: info.name,
        state: state}) %> <%- include('../partials/sidebar_subreddit_info',
        {desc: info.description}) %>
      </div>

      <div class="main">
        <%- include('../partials/sort') %> <% if (posts != undefined) {
        posts.forEach((post) => { %>
        <article class="post" data-ref="<%= post._id %>">
          <div class="arrows">
            <div class="upvote-post auth-req"
              ><i class="far fa-caret-square-up"></i
            ></div>
            <span class="post-votes" data-ref="<%= post._id %>"
              ><%= post.votes %></span
            >
            <div class="downvote-post auth-req"
              ><i class="far fa-caret-square-down"></i
            ></div>
          </div>

          <% if(post.type == "img") { %>
          <a href="<%= post.link %>"
            ><img src="<%=post.link%>" height="55" width="55" class="thumbnail"
          /></a>
          <% } else if (post.type == "link") { %>
          <a href="<%= post.link %>"
            ><img
              src="/images/link.png"
              height="55"
              width="55"
              class="thumbnail"
          /></a>
          <% } else { %>
          <a href="/r/<%= post.subreddit %>/<%= post._id %>"
            ><img
              src="/images/post.png"
              height="55"
              width="55"
              class="thumbnail"
          /></a>
          <% } %>

          <div class="info">
            <header>
              <% if(post.type == "post") { %>
              <a href="/r/<%= post.subreddit %>/<%= post._id %>"
                ><%= post.title %></a
              >
              <% } else { %>
              <a href="<%= post.link %>"><%= post.title %></a>
              <% } %>
            </header>
            <div>
              submitted <time title="<%= post.time %>">-</time> by
              <span class="post-user"
                ><a href="/u/<%= post.username %>"
                  ><%= post.username %></a
                ></span
              >
              from
              <span
                ><a href="/r/<%= post.subreddit %>"
                  >/r/<%= post.subreddit %></a
                ></span
              >
            </div>
            <ul class="post-options">
              <li
                ><a href="/r/<%=post.subreddit %>/<%= post._id %>"
                  ><%=post.num_of_comments%> comments</a
                ></li
              >
              <li
                ><a href="javascript:void(0)" class="save-post auth-req"
                  >save</a
                ></li
              >
              <% if(post.username == locals.user) { %>
              <li
                ><a href="javascript:void(0)" class="delete-post auth-req"
                  >delete</a
                ></li
              >
              <% } %>
            </ul>
          </div>
        </article>
        <% });%> <% } else { %> There are no posts. <% } %>
      </div>
    </div>

    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
      integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"
      integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s"
      crossorigin="anonymous"
    ></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/autosize@4.0.2/dist/autosize.min.js"></script>

    <script defer src="/js/load.js"></script>
    <script src="/js/index.js"></script>
    <script src="/js/post.js"></script>
    <script src="/js/subreddit.js"></script>
    <script src="/js/sort.js"></script>
  </body>
</html>
